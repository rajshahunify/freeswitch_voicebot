[supervisord]
nodaemon=true
logfile=/var/log/supervisord.log
pidfile=/var/run/supervisord.pid
loglevel=info

; =============================================================================
; FreeSWITCH - must start first
; =============================================================================
[program:freeswitch]
command=/usr/local/freeswitch/bin/freeswitch -nonat -nf -c
autostart=true
autorestart=true
priority=10
startsecs=5
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

; =============================================================================
; VoiceBot WebSocket Server (server.py)
; Waits for FreeSWITCH to be ready before starting
; =============================================================================
[program:voicebot-server]
command=python3 /opt/voicebot/server.py
directory=/opt/voicebot
autostart=true
autorestart=true
priority=20
startsecs=15
startretries=5
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

; =============================================================================
; VoiceBot ESL Agent (agent.py)
; Waits for both FreeSWITCH and server.py to be ready
; =============================================================================
[program:voicebot-agent]
command=python3 /opt/voicebot/agent.py
directory=/opt/voicebot
autostart=true
autorestart=true
priority=30
startsecs=20
startretries=5
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
